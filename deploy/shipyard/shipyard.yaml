apiVersion: "spec.keptn.sh/0.2.2"
kind: "Shipyard"
metadata:
  name: "shipyard-demoserviceapps"
spec:
  stages:
    - name: "staging"
      sequences:
            - name: "delivery"
              tasks:
                - name: "deployment"
                  properties:
                    deploymentstrategy: "blue_green_service"
                - name: "test"
                  properties:
                    teststrategy: "functional"
                - name: "evaluation"
                - name: "release"      
    - name: hardening
      sequences:
            - name: "delivery"
              tasks:
                - name: "deployment"
                  properties:
                    deploymentstrategy: "blue_green_service"
                - name: "test"
                  properties:
                    teststrategy: "performance"
                - name: "evaluation"
                - name: "release"
    - name: production
      sequences:
        - name: approval
          properties:
            pass: manual
            warning: manual
        - name: delivery
          triggeredOn:
          - event: hardening.delivery.finished
          tasks:
          - name: deployment
            properties:
                deploymentstrategy: "blue_green_service"
          - name: release
        - name: rollback
          triggeredOn:
          - event: production.delivery.finished
            selector:
              match:
                result: failed
          tasks:
          - name: rollback
        - name: remediation
          tasks:
          - name: remediation
          - name: evaluation
            triggeredAfter: "10m"
